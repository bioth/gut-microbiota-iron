p
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
taxGlomResAndStats(ps_samuel, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c("Wt:Vehicle", "Wt:Putrescine"),
c("IL-22ra1-/-:Vehicle", "IL-22ra1-/-:Putrescine"),
c("Wt:Vehicle","IL-22ra1-/-:Vehicle"),
c("Wt:Putrescine","IL-22ra1-/-:Putrescine")),
path = "~/Documents/CHUM_git/figures/samuel/phyla_rel_ab", include_graph = TRUE)
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
taxGlomResAndStats(ps_samuel, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c("Wt:Vehicle", "Wt:Putrescine"),
c("IL-22ra1-/-:Vehicle", "IL-22ra1-/-:Putrescine"),
c("Wt:Vehicle","IL-22ra1-/-:Vehicle"),
c("Wt:Putrescine","IL-22ra1-/-:Putrescine")),
path = "~/Documents/CHUM_git/figures/samuel/phyla_rel_ab", include_graph = TRUE)
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
taxGlomResAndStats(ps_samuel, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c("Wt:Vehicle", "Wt:Putrescine"),
c("IL-22ra1-/-:Vehicle", "IL-22ra1-/-:Putrescine"),
c("Wt:Vehicle","IL-22ra1-/-:Vehicle"),
c("Wt:Putrescine","IL-22ra1-/-:Putrescine")),
path = "~/Documents/CHUM_git/figures/samuel/phyla_rel_ab", include_graph = TRUE)
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
taxGlomResAndStats(ps_samuel, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c("Wt:Vehicle", "Wt:Putrescine"),
c("IL-22ra1-/-:Vehicle", "IL-22ra1-/-:Putrescine"),
c("Wt:Vehicle","IL-22ra1-/-:Vehicle"),
c("Wt:Putrescine","IL-22ra1-/-:Putrescine")),
path = "~/Documents/CHUM_git/figures/samuel/phyla_rel_ab", include_graph = TRUE)
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
taxGlomResAndStats(ps_samuel, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c("Wt:Vehicle", "Wt:Putrescine"),
c("IL-22ra1-/-:Vehicle", "IL-22ra1-/-:Putrescine"),
c("Wt:Vehicle","IL-22ra1-/-:Vehicle"),
c("Wt:Putrescine","IL-22ra1-/-:Putrescine")),
path = "~/Documents/CHUM_git/figures/samuel/phyla_rel_ab", include_graph = TRUE)
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
taxGlomResAndStats(ps_samuel, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c("Wt:Vehicle", "Wt:Putrescine"),
c("IL-22ra1-/-:Vehicle", "IL-22ra1-/-:Putrescine"),
c("Wt:Vehicle","IL-22ra1-/-:Vehicle"),
c("Wt:Putrescine","IL-22ra1-/-:Putrescine")),
path = "~/Documents/CHUM_git/figures/samuel/phyla_rel_ab", include_graph = TRUE)
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
taxGlomResAndStats(ps_samuel, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c("Wt:Vehicle", "Wt:Putrescine"),
c("IL-22ra1-/-:Vehicle", "IL-22ra1-/-:Putrescine"),
c("Wt:Vehicle","IL-22ra1-/-:Vehicle"),
c("Wt:Putrescine","IL-22ra1-/-:Putrescine")),
path = "~/Documents/CHUM_git/figures/samuel/phyla_rel_ab", include_graph = TRUE)
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
taxGlomResAndStats(ps_samuel, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c("Wt:Vehicle", "Wt:Putrescine"),
c("IL-22ra1-/-:Vehicle", "IL-22ra1-/-:Putrescine"),
c("Wt:Vehicle","IL-22ra1-/-:Vehicle"),
c("Wt:Putrescine","IL-22ra1-/-:Putrescine")),
path = "~/Documents/CHUM_git/figures/samuel/phyla_rel_ab", include_graph = TRUE)
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
taxGlomResAndStats(ps_samuel, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c("Wt:Vehicle", "Wt:Putrescine"),
c("IL-22ra1-/-:Vehicle", "IL-22ra1-/-:Putrescine"),
c("Wt:Vehicle","IL-22ra1-/-:Vehicle"),
c("Wt:Putrescine","IL-22ra1-/-:Putrescine")),
path = "~/Documents/CHUM_git/figures/samuel/phyla_rel_ab", include_graph = TRUE)
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
taxGlomResAndStats(ps_samuel, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c("Wt:Vehicle", "Wt:Putrescine"),
c("IL-22ra1-/-:Vehicle", "IL-22ra1-/-:Putrescine"),
c("Wt:Vehicle","IL-22ra1-/-:Vehicle"),
c("Wt:Putrescine","IL-22ra1-/-:Putrescine")),
path = "~/Documents/CHUM_git/figures/samuel/phyla_rel_ab", include_graph = TRUE)
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
taxGlomResAndStats(ps_samuel, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c("Wt:Vehicle", "Wt:Putrescine"),
c("IL-22ra1-/-:Vehicle", "IL-22ra1-/-:Putrescine"),
c("Wt:Vehicle","IL-22ra1-/-:Vehicle"),
c("Wt:Putrescine","IL-22ra1-/-:Putrescine")),
path = "~/Documents/CHUM_git/figures/samuel/phyla_rel_ab", include_graph = TRUE)
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
taxGlomResAndStats(ps_samuel, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c("Wt:Vehicle", "Wt:Putrescine"),
c("IL-22ra1-/-:Vehicle", "IL-22ra1-/-:Putrescine"),
c("Wt:Vehicle","IL-22ra1-/-:Vehicle"),
c("Wt:Putrescine","IL-22ra1-/-:Putrescine")),
path = "~/Documents/CHUM_git/figures/samuel/phyla_rel_ab", include_graph = TRUE)
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
# Agglomerates asvs at phylum level and returns stats and results relative_abundance (Claire)
taxGlomResAndStats(ps_claire, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c( "50 ppm / 3w",  "500 ppm / 3w"),
c( "50 ppm / 8w",  "500 ppm / 8w"),
c( "50 ppm / 10w",  "500 ppm / 10w"),
c("50 ppm / 14w", "500 ppm / 14w")),
path = "~/Documents/CHUM_git/figures/claire/phyla_rel_ab", include_graph = FALSE)
sample_data(ps_claire)
sample_data(ps_claire)$gg_group
#for Claire's data, put gg_group as factor and define order
sample_data(ps_claire)$gg_group <- factor(sample_data(ps_claire)$gg_group, levels = c("3:50", "8:50", "10:50", "14:50", "3:500", "8:500", "10:500", "14:500"))
# Enables to rename factor levels (this is more convenient to change the names for each subgraph
# in the facet_wrap.)
library(forcats)
sample_data(ps_claire)$gg_group <- fct_recode(sample_data(ps_claire)$gg_group,
"50 ppm / 3w"="3:50",
"50 ppm / 8w"="8:50",
"50 ppm / 10w"="10:50",
"50 ppm / 14w"="14:50",
"500 ppm / 3w"="3:500",
"500 ppm / 8w"="8:500",
"500 ppm / 10w"="10:500",
"500 ppm / 14w"="14:500")
# Agglomerates asvs at phylum level and returns stats and results relative_abundance (Claire)
taxGlomResAndStats(ps_claire, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c( "50 ppm / 3w",  "500 ppm / 3w"),
c( "50 ppm / 8w",  "500 ppm / 8w"),
c( "50 ppm / 10w",  "500 ppm / 10w"),
c("50 ppm / 14w", "500 ppm / 14w")),
path = "~/Documents/CHUM_git/figures/claire/phyla_rel_ab", include_graph = FALSE)
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
# Agglomerates asvs at phylum level and returns stats and results relative_abundance (Claire)
taxGlomResAndStats(ps_claire, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c( "50 ppm / 3w",  "500 ppm / 3w"),
c( "50 ppm / 8w",  "500 ppm / 8w"),
c( "50 ppm / 10w",  "500 ppm / 10w"),
c("50 ppm / 14w", "500 ppm / 14w")),
path = "~/Documents/CHUM_git/figures/claire/phyla_rel_ab", include_graph = FALSE)
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
# Agglomerates asvs at phylum level and returns stats and results relative_abundance (Claire)
taxGlomResAndStats(ps_claire, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c( "50 ppm / 3w",  "500 ppm / 3w"),
c( "50 ppm / 8w",  "500 ppm / 8w"),
c( "50 ppm / 10w",  "500 ppm / 10w"),
c("50 ppm / 14w", "500 ppm / 14w")),
path = "~/Documents/CHUM_git/figures/claire/phyla_rel_ab", include_graph = FALSE)
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
# Agglomerates asvs at phylum level and returns stats and results relative_abundance (Claire)
taxGlomResAndStats(ps_claire, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c( "50 ppm / 3w",  "500 ppm / 3w"),
c( "50 ppm / 8w",  "500 ppm / 8w"),
c( "50 ppm / 10w",  "500 ppm / 10w"),
c("50 ppm / 14w", "500 ppm / 14w")),
path = "~/Documents/CHUM_git/figures/claire/phyla_rel_ab", include_graph = FALSE)
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
# Agglomerates asvs at phylum level and returns stats and results relative_abundance (Claire)
taxGlomResAndStats(ps_claire, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c( "50 ppm / 3w",  "500 ppm / 3w"),
c( "50 ppm / 8w",  "500 ppm / 8w"),
c( "50 ppm / 10w",  "500 ppm / 10w"),
c("50 ppm / 14w", "500 ppm / 14w")),
path = "~/Documents/CHUM_git/figures/claire/phyla_rel_ab", include_graph = FALSE)
ps_claire <- subset_samples(ps, student == "Claire")
sum(taxa_sums(ps_claire))
length(taxa_sums(ps_claire))
ps_claire <- prune_taxa(taxa_sums(ps_claire) > 0, ps_claire) #Actual ASVs from Claire's data
sum(taxa_sums(ps_claire))
length(taxa_sums(ps_claire))
ps_claire <- prune_taxa(taxa_sums(ps_claire) > 10, ps_claire)
sum(taxa_sums(ps_claire))
length(taxa_sums(ps_claire))
ps_claire <- prune_taxa(colSums(otu_table(ps_claire) > 0) >= (0.05 * nsamples(ps_claire)), ps_claire)
sum(taxa_sums(ps_claire))
length(taxa_sums(ps_claire))
#for Claire's data, put gg_group as factor and define order
sample_data(ps_claire)$gg_group <- factor(sample_data(ps_claire)$gg_group, levels = c("3:50", "8:50", "10:50", "14:50", "3:500", "8:500", "10:500", "14:500"))
# sample_data(ps_claire)$gg_group <- fct_recode(sample_data(ps_claire)$gg_group,
#                                               "50 ppm / 3w"="3:50",
#                                               "50 ppm / 8w"="8:50",
#                                               "50 ppm / 10w"="10:50",
#                                               "50 ppm / 14w"="14:50",
#                                               "500 ppm / 3w"="3:500",
#                                               "500 ppm / 8w"="8:500",
#                                               "500 ppm / 10w"="10:500",
#                                               "500 ppm / 14w"="14:500")
# Agglomerates asvs at phylum level and returns stats and results relative_abundance (Claire)
taxGlomResAndStats(ps_claire, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c( "3:50",  "3:500"),
c( "8:50",  "8:500"),
c( "10:50",  "10:500"),
c( "14:50",  "14:500")),
path = "~/Documents/CHUM_git/figures/claire/phyla_rel_ab", include_graph = FALSE)
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
# sample_data(ps_claire)$gg_group <- fct_recode(sample_data(ps_claire)$gg_group,
#                                               "50 ppm / 3w"="3:50",
#                                               "50 ppm / 8w"="8:50",
#                                               "50 ppm / 10w"="10:50",
#                                               "50 ppm / 14w"="14:50",
#                                               "500 ppm / 3w"="3:500",
#                                               "500 ppm / 8w"="8:500",
#                                               "500 ppm / 10w"="10:500",
#                                               "500 ppm / 14w"="14:500")
# Agglomerates asvs at phylum level and returns stats and results relative_abundance (Claire)
taxGlomResAndStats(ps_claire, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c( "3:50",  "3:500"),
c( "8:50",  "8:500"),
c( "10:50",  "10:500"),
c( "14:50",  "14:500")),
path = "~/Documents/CHUM_git/figures/claire/phyla_rel_ab", include_graph = FALSE)
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
# sample_data(ps_claire)$gg_group <- fct_recode(sample_data(ps_claire)$gg_group,
#                                               "50 ppm / 3w"="3:50",
#                                               "50 ppm / 8w"="8:50",
#                                               "50 ppm / 10w"="10:50",
#                                               "50 ppm / 14w"="14:50",
#                                               "500 ppm / 3w"="3:500",
#                                               "500 ppm / 8w"="8:500",
#                                               "500 ppm / 10w"="10:500",
#                                               "500 ppm / 14w"="14:500")
# Agglomerates asvs at phylum level and returns stats and results relative_abundance (Claire)
taxGlomResAndStats(ps_claire, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c( "3:50",  "3:500"),
c( "8:50",  "8:500"),
c( "10:50",  "10:500"),
c( "14:50",  "14:500")),
path = "~/Documents/CHUM_git/figures/claire/phyla_rel_ab", include_graph = FALSE)
source("~/Documents/CHUM_git/gut-microbiota-iron/pipeline_linux/microbiota_analysis/taxa_distrib_graphs_and_stats.R")
# Agglomerates asvs at phylum level and returns stats and results relative_abundance (Samuel)
taxGlomResAndStats(ps_samuel, taxrank = "Phylum", exp_group = "gg_group",
selected_comparisons = list(c("Wt:Vehicle", "Wt:Putrescine"),
c("IL-22ra1-/-:Vehicle", "IL-22ra1-/-:Putrescine"),
c("Wt:Vehicle","IL-22ra1-/-:Vehicle"),
c("Wt:Putrescine","IL-22ra1-/-:Putrescine")),
path = "~/Documents/CHUM_git/figures/samuel/phyla_rel_ab", include_graph = FALSE)
#loading libraries
{
library("tidyverse") #loading bunch of packages
library("ggplot2") #come on, everyone knows what it is used for
library("dplyr") #arranging and manipulating data easily
library("geepack") #library for loading GEE tests
library("lme4") #library for loading ANOVA
library("car") #for anova too
library("ggsignif") #adding significance bars to ggplots
library("Hmisc") #idk lol
library("readxl")
library("esquisse")
}
setwd("~/Documents/CHUM_git/gut-microbiota-iron/")
#loading functions for data manipulation
source("other scripts/dataManipFunctions.R")
# All graphs regarding young mice experiment
setwd("experiments/finished exp/young-DSS-exp3/")
# Mice weight evolution
young_weight <- read.csv("young48_weight_cageChanges.csv", header = TRUE, sep = ";")
View(young_weight)
young_weight <- young_weight[,-c(6:10)] #removing first week body weight measurements
young_weight <- weightDataManipulation(young_weight,4, fromDay0 = TRUE) #Manipulating weight measures data
#creating scatter plot with the four different treatments (diet combined with dss or control)
young_weight_plot <- weightPlot(young_weight, percentage = TRUE, diet_only = FALSE)
young_weight_plot
#creating scatter plot with the four different treatments (diet combined with dss or control)
young_weight_plot <- weightPlot(young_weight, percentage = FALSE, diet_only = FALSE)
young_weight_plot
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
#creating scatter plot with the four different treatments (diet combined with dss or control)
young_weight_plot <- weightPlot(young_weight, percentage = FALSE, diet_only = FALSE)
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
#creating scatter plot with the four different treatments (diet combined with dss or control)
young_weight_plot <- weightPlot(young_weight, percentage = FALSE, diet_only = FALSE)
young_weight_plot
# Mice DAI evolution
young_dss_followup <- read.csv("young48_dss_followup.csv", header = TRUE, sep = ";")
young_dss_followup <- dssFollowupManipulation(df = young_dss_followup,groupInfoCols = 4,dateStart = "2024-05-29",nbrDays = 5, negativeOnly = TRUE)
# creating scatter plot with the four different treatments (diet combined with dss or control)
# This graph has a disease activity index score in the y column
young_dssflwup_plot <- dssDiseaseIndexPlot(young_dss_followup)
young_dssflwup_plot
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
# creating scatter plot with the four different treatments (diet combined with dss or control)
# This graph has a disease activity index score in the y column
young_dssflwup_plot <- dssDiseaseIndexPlot(young_dss_followup)
young_dssflwup_plot
a = 1
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
young_dss_followup <- dssFollowupManipulation(df = young_dss_followup,groupInfoCols = 4,dateStart = "2024-05-29",nbrDays = 5, negativeOnly = TRUE)
# Mice DAI evolution
young_dss_followup <- read.csv("young48_dss_followup.csv", header = TRUE, sep = ";")
young_dss_followup <- dssFollowupManipulation(df = young_dss_followup,groupInfoCols = 4,dateStart = "2024-05-29",nbrDays = 5, negativeOnly = TRUE)
# creating scatter plot with the four different treatments (diet combined with dss or control)
# This graph has a disease activity index score in the y column
young_dssflwup_plot <- dssDiseaseIndexPlot(young_dss_followup)
young_dssflwup_plot
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
# Mice DAI evolution
young_dss_followup <- read.csv("young48_dss_followup.csv", header = TRUE, sep = ";")
young_dss_followup <- dssFollowupManipulation(df = young_dss_followup,groupInfoCols = 4,dateStart = "2024-05-29",nbrDays = 5, negativeOnly = TRUE)
# creating scatter plot with the four different treatments (diet combined with dss or control)
# This graph has a disease activity index score in the y column
young_dssflwup_plot <- dssDiseaseIndexPlot(young_dss_followup)
young_dssflwup_plot
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
# creating scatter plot with the four different treatments (diet combined with dss or control)
# This graph has a disease activity index score in the y column
young_dssflwup_plot <- dssDiseaseIndexPlot(young_dss_followup)
young_dssflwup_plot
#DAI measures at final day of DSS
young_final_DSI_plot <- dssDsiFinalDay(young_dss_followup)
young_final_DSI_plot
# Mice dissection data
dissec_young <- read.csv("young48_dss_dissection.csv", sep = ";", header = TRUE)
dissec_young <- dissectionDataManipulation(dissec_young,4)
# Mice dissection data
dissec_young <- read.csv("young48_dss_dissection.csv", sep = ";", header = TRUE)
dissec_young <- dissectionDataManipulation(dissec_young,4)
#boxplot for body weight
young_dissec_bw <- dissecBoxplot(dissec_young,"body",display_significance_bars = FALSE)
young_dissec_bw
#boxplot for body weight
young_dissec_bw <- dissecBoxplot(dissec_young,"body",display_significance_bars = TRUE)
young_dissec_bw
#boxplot for body weight
young_dissec_bw <- dissecBoxplot(dissec_young,"body")
young_dissec_bw
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
#boxplot for body weight
young_dissec_bw <- dissecBoxplot(dissec_young,"body")
young_dissec_bw
# Mice dissection data
dissec_young <- read.csv("young48_dss_dissection.csv", sep = ";", header = TRUE)
dissec_young <- dissectionDataManipulation(dissec_young,4)
unique(dissec_young$gg_group)
dissec_young$gg_group <- factor(dissec_young$gg_group, levels = c("50 water","500 water","50 dss","500 dss"))
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
#boxplot for body weight
young_dissec_bw <- dissecBoxplot(dissec_young,"body")
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
#boxplot for body weight
young_dissec_bw <- dissecBoxplot(dissec_young,"body")
View(dissec_young)
# Mice dissection data
dissec_young <- read.csv("young48_dss_dissection.csv", sep = ";", header = TRUE)
dissec_young <- dissectionDataManipulation(dissec_young,4)
dissec_young$gg_group <- factor(dissec_young$gg_group, levels = c("50 water","500 water","50 dss","500 dss"))
#boxplot for body weight
young_dissec_bw <- dissecBoxplot(dissec_young,"body")
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
#boxplot for body weight
young_dissec_bw <- dissecBoxplot(dissec_young,"body")
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
#boxplot for body weight
young_dissec_bw <- dissecBoxplot(dissec_young,"body")
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
#boxplot for body weight
young_dissec_bw <- dissecBoxplot(dissec_young,"body")
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
#boxplot for body weight
young_dissec_bw <- dissecBoxplot(dissec_young,"body")
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
#boxplot for body weight
young_dissec_bw <- dissecBoxplot(dissec_young,"body")
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
#boxplot for body weight
young_dissec_bw <- dissecBoxplot(dissec_young,"body")
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
#boxplot for body weight
young_dissec_bw <- dissecBoxplot(dissec_young,"body")
young_dissec_bw
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
young_dissec_bw
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
#boxplot for body weight
young_dissec_bw <- dissecBoxplot(dissec_young,"body")
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
#boxplot for body weight
young_dissec_bw <- dissecBoxplot(dissec_young,"body")
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
#boxplot for body weight
young_dissec_bw <- dissecBoxplot(dissec_young,"body")
young_dissec_bw
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
#boxplot for body weight
young_dissec_bw <- dissecBoxplot(dissec_young,"body")
young_dissec_bw
#boxplot for std liver weight
young_dissec_lvr <- dissecBoxplot(dissec_young,"liver")
young_dissec_lvr
#boxplot for std spleen weight
young_dissec_spln <- dissecBoxplot(dissec_young,"spleen")
young_dissec_spln
View(young_dissec_spln)
df <- young_dissec_spln$data
df
View(df)
dss50 <- df[df$gg_group == "50 dss",]
dss500 <- df[df$gg_group == "500 dss",]
water50 <- df[df$gg_group == "50 water",]
water500 <- df[df$gg_group == "500 water",]
# Shapiro-Wilk test for normality
print(shapiro.test(dss50[["std_spleen_weight"]]))
dss50
# Shapiro-Wilk test for normality
print(shapiro.test(dss50[["std_spleen_weigth"]]))
# Shapiro-Wilk test for normality
print(shapiro.test(dss50[["std_spleen_weigth"]]))
print(shapiro.test(dss500[["std_spleen_weigth"]]))
print(shapiro.test(water50[["std_spleen_weigth"]]))
print(shapiro.test(water500[["std_spleen_weigth"]]))
df$log_spleen <- log(df$std_spleen_weigth)
print(shapiro.test(dss50[["log_spleen"]]))
dss50 <- df[df$gg_group == "50 dss",]
dss500 <- df[df$gg_group == "500 dss",]
water50 <- df[df$gg_group == "50 water",]
water500 <- df[df$gg_group == "500 water",]
print(shapiro.test(dss50[["log_spleen"]]))
print(shapiro.test(dss500[["log_spleen"]]))
print(shapiro.test(water50[["log_spleen"]]))
print(shapiro.test(water500[["log_spleen"]]))
print(shapiro.test(dss50[["log_spleen"]]))
print(shapiro.test(dss500[["log_spleen"]]))
print(shapiro.test(water50[["log_spleen"]]))
print(shapiro.test(water500[["log_spleen"]]))
df$log_spleen <- sqrt(df$std_spleen_weigth)
dss50 <- df[df$gg_group == "50 dss",]
dss500 <- df[df$gg_group == "500 dss",]
water50 <- df[df$gg_group == "50 water",]
water500 <- df[df$gg_group == "500 water",]
print(shapiro.test(dss50[["log_spleen"]]))
print(shapiro.test(dss500[["log_spleen"]]))
print(shapiro.test(water50[["log_spleen"]]))
print(shapiro.test(water500[["log_spleen"]]))
hist(dss50[["log_spleen"]])
hist(dss50[["log_spleen"]], breaks = 10)
hist(dss50[["log_spleen"]], breaks = 15)
print(shapiro.test(dss50[["log_spleen"]]))
print(shapiro.test(dss500[["log_spleen"]]))
hist(dss500[["log_spleen"]], breaks = 15)
dss500
View(dss500)
df$log_spleen <- log(df$std_spleen_weigth)
dss50 <- df[df$gg_group == "50 dss",]
dss500 <- df[df$gg_group == "500 dss",]
water50 <- df[df$gg_group == "50 water",]
water500 <- df[df$gg_group == "500 water",]
print(shapiro.test(dss50[["log_spleen"]]))
print(shapiro.test(dss500[["log_spleen"]]))
hist(dss500[["log_spleen"]], breaks = 15)
View(dss500)
dss500 <- dss500[-45,]
print(shapiro.test(dss500[["log_spleen"]]))
hist(dss500[["log_spleen"]], breaks = 15)
dss500[45,]
dss500[10,]
dss500[9,]
dss500 <- dss500[-9,]
print(shapiro.test(dss500[["log_spleen"]]))
hist(dss500[["log_spleen"]], breaks = 15)
print(shapiro.test(water50[["log_spleen"]]))
print(shapiro.test(water500[["log_spleen"]]))
df["id" == "10966B"]
df[,"id" == "10966B"]
df$id == "10966B"
df <- df[-df$id == "10966B"]
df[,"id"]
df[,"id" == "10966B"]
df[,"id" = "10966B"]
df[,"id" == "10966B"]
df["id" == "10966B"]
df["id" == "10966B",]
df[,"id" %in% "10966B"]
df["id" %in% "10966B"]
df["id" %in% "10966B"]
df["id" %in% "10966B",]
df["id" %in% "10966B"]
df <- df[df$id != "10966B", ]
# Levene's test for homogeneity of variance
print(leveneTest(df[[responseVariable]] ~ gg_group, data = df))
# Levene's test for homogeneity of variance
print(leveneTest(df[["log_spleen"]] ~ gg_group, data = df))
# Perform anova
result <- aov(df[["log_spleen"]] ~ treatment * diet, data = df)
print(summary(result))
print(TukeyHSD(result))
# boxplot for std spleen weight
young_dissec_spln <- dissecBoxplot(dissec_young,"spleen")
young_dissec_spln
result <- oneway.test(log_spleen ~ treatment *diet, data = df, var.equal = FALSE)
print(result)
result <- oneway.test(log_spleen ~ treatment , data = df, var.equal = FALSE)
print(result)
result <- oneway.test(log_spleen ~ treatment *diet, data = df, var.equal = FALSE)
print(result)
install.packages("rstatix")
install.packages("rstatix")
library(rstatix)
post_hoc <- df %>% games_howell_test(log_spleen ~ treatment *diet)
result <- oneway.test(log_spleen ~ gg_group, data = df, var.equal = FALSE)
print(result)
p
post_hoc <- df %>% games_howell_test(log_spleen ~ gg_group)
print(post_hoc)
#boxplot for colon length (non std)
young_dissec_cln <- dissecBoxplot(dissec_young,"colon")
young_dissec_cln
source("~/Documents/CHUM_git/gut-microbiota-iron/other scripts/dataManipFunctions.R")
dissec_young$colon_length_nrm <- dissec_young$colon_length/dissec_young$body_weight
# boxplot for colon length normalized for body weight
young_dissec_cln <- dissecBoxplot(dissec_young,"colon_nrm")
young_dissec_cln
View(df)
model <- lm(log_spleen ~ treatment * diet, data = df)
result <- anova(model)
print(summary(result))
result
print(result)
print(TukeyHSD(result))
# Compute estimated marginal means (EMMs)
emm <- emmeans(model, pairwise ~ treatment * diet)
library(emmeans)
# Compute estimated marginal means (EMMs)
emm <- emmeans(model, pairwise ~ treatment * diet)
# Display results
summary(emm)
# creating scatter plot with the four different treatments (diet combined with dss or control)
young_weight_plot <- weightPlot(young_weight, percentage = FALSE, diet_only = FALSE)
young_weight_plot
